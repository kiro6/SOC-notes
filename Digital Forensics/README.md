
# Windows Forensics 
## NTFS

| Evidence Type                  | Description                                                                                                                                     |
|--------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------|
| File Metadata                  | NTFS stores extensive metadata for each file, including creation time, modification time, access time, and attribute information.                |
| MFT Entries                    | The Master File Table (MFT) stores metadata for all files and directories on a volume, providing insights into file names, sizes, and timestamps.|
| File Slack and Unallocated Space | Unallocated space may contain remnants of deleted files or fragments of data. File slack refers to the unused portion of a cluster.               |
| File Signatures                | File headers and signatures can identify file types even when file extensions are changed or obscured.                                           |
| USN Journal                    | The Update Sequence Number (USN) Journal records changes made to files and directories, allowing tracking of file modifications and deletions.     |
| LNK Files                      | Windows shortcut files contain information about target files/programs and timestamps, providing insights into recent activities.                  |
| Prefetch Files                 | Prefetch files generated by Windows indicate which programs have been run on the system and when they were last executed.                        |
| Registry Hives                 | Windows Registry hives contain important configuration and system information, revealing traces of malicious activities or unauthorized changes.  |
| Shellbags                      | Shellbags store folder view settings, revealing user navigation patterns and accessed folders.                                                    |
| Thumbnail Cache                | Thumbnail caches reveal recently viewed files, even if the originals are deleted.                                                                |
| Recycle Bin                    | The Recycle Bin contains deleted files, providing insights into user actions.                                                                    |
| Alternate Data Streams (ADS)   | ADS are additional data streams associated with files, sometimes used maliciously to hide data.                                                    |
| Volume Shadow Copies           | Volume Shadow Copies are snapshots of the file system at different points in time, valuable for data recovery and analysis.                        |
| Security Descriptors and ACLs  | Access Control Lists (ACLs) and security descriptors determine file/folder permissions, aiding in understanding access rights and security breaches.|


## Windows Event Logs
for offline analysis, investigators should navigate to the default file path for log storage at C:\Windows\System32\winevt\logs


## Execution Artifacts

| Artifact          | Location/Registry Key                                           | Data Stored                                                                                       |
|-------------------|-----------------------------------------------------------------|---------------------------------------------------------------------------------------------------|
| Prefetch Files    | C:\Windows\Prefetch                                             | Metadata about executed applications (file paths, timestamps, execution count)                    |
| Shimcache         | Registry: HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\AppCompatCache | Program execution details (file paths, timestamps, flags)                                         |
| Amcache           | C:\Windows\AppCompat\Programs\Amcache.hve (Binary Registry Hive) | Application details (file paths, sizes, digital signatures, timestamps)                            |
| UserAssist        | Registry: HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist | Executed program details (application names, execution counts, timestamps)                         |
| RunMRU Lists      | Registry: HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU     | Recently executed programs and their command lines                                                |
| Jump Lists        | User-specific folders (e.g., %AppData%\Microsoft\Windows\Recent) | Recently accessed files, folders, and tasks associated with applications                          |
| Shortcut (LNK) Files | Various locations (e.g., Desktop, Start Menu)                 | Target executable, file paths, timestamps, user interactions                                      |
| Recent Items      | User-specific folders (e.g., %AppData%\Microsoft\Windows\Recent) | Recently accessed files                                                                           |
| Windows Event Logs | C:\Windows\System32\winevt\Logs                                | Various event logs containing process creation, termination, and other events                      |
## Windows Persistence Artifacts


### Run/RunOnce Keys
- HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run
- HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce
- HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
- HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce
- HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\

### Keys used by WinLogon Process
- HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon
- HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell

### Startup Keys
- HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders
- HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders
- HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders
- HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User

### Schtasks
-  C:\Windows\System32\Tasks

### Services
- HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services


## Web Browser Forensics

| Artifact              | Description                                                                                                       |
|-----------------------|-------------------------------------------------------------------------------------------------------------------|
| Browsing History      | Records of websites visited, including URLs, titles, timestamps, and visit frequency.                             |
| Cookies               | Small data files stored by websites on a user's device, containing information such as session details, preferences, and authentication tokens. |
| Cache                 | Cached copies of web pages, images, and other content visited by the user. Can reveal websites accessed even if the history is cleared. |
| Bookmarks/Favorites   | Saved links to frequently visited websites or pages of interest.                                                    |
| Download History      | Records of downloaded files, including source URLs, filenames, and timestamps.                                     |
| Autofill Data         | Information automatically entered into forms, such as names, addresses, and passwords.                              |
| Search History        | Queries entered into search engines, along with search terms and timestamps.                                       |
| Session Data          | Information about active browsing sessions, tabs, and windows.                                                      |
| Typed URLs            | URLs entered directly into the address bar.                                                                        |
| Form Data             | Information entered into web forms, such as login credentials and search queries.                                   |
| Passwords             | Saved or autofilled passwords for websites.                                                                        |
| Web Storage           | Local storage data used by websites for various purposes.                                                          |
| Favicons              | Small icons associated with websites, which can reveal visited sites.                                               |
| Tab Recovery Data     | Information about open tabs and sessions that can be restored after a browser crash.                                |
| Extensions and Add-ons| Installed browser extensions and their configurations.                                                             |



## System Resource Usage Monitor
- SRUM meticulously tracks resource utilization and application usage patterns.
- The data is housed in a database file named sru.db found in the C:\Windows\System32\sru directory. 
- This SQLite formatted database allows for structured data storage and efficient data retrieval.

- **Application Profiling:** SRUM provides a comprehensive view of executed applications and processes on a Windows system, recording details such as executable names, file paths, timestamps, and resource usage metrics. This information is vital for understanding the software landscape, identifying potentially malicious or unauthorized applications, and reconstructing user activities.

- **Resource Consumption:** SRUM captures data on CPU time, network usage, and memory consumption for each application and process. This data is invaluable for investigating resource-intensive activities, identifying unusual resource consumption patterns, and detecting potential performance issues caused by specific applications.

- **Timeline Reconstruction:** Analyzing SRUM data enables digital forensics experts to create timelines of application and process execution, resource usage, and system activities. This timeline reconstruction helps in understanding the sequence of events, identifying suspicious behaviors, and establishing a clear picture of user interactions and actions.

- **User and System Context:** SRUM data includes user identifiers, facilitating the attribution of activities to specific users. This aids in user behavior analysis and helps determine whether certain actions were performed by legitimate users or potential threat actors.

- **Malware Analysis and Detection:** SRUM data can be leveraged to identify unusual or unauthorized applications indicative of malware or malicious activities. Sudden spikes in resource usage, abnormal application patterns, or unauthorized software installations can all be detected through SRUM analysis.

- **Incident Response:** During incident response, SRUM provides rapid insights into recent application and process activities, enabling analysts to quickly identify potential threats and respond effectively.
